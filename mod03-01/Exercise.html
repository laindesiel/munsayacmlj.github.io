<!DOCTYPE html>
<html>
    <head>
       
       <title>Catch the Squares!</title>
        <style>
            
            *{
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            html{
                width: 100%;
                height: 100%;
                background-color: #fff;
                position: relative;
            }
            
            body{
                height: 100%;
            }
            
            #play{
                width: 60%;
                height: 100%;
                margin: 0 auto;
                background-color: #d3d3d3;
                position: relative;
            }
            
            #coolDiv {
                width: 50px;
                height: 50px;
                position: absolute;
                top: 0;
                right: 0;
                background: black;
                border: 2px solid #333;
                border-radius: 5px;
                color: #fff;
            }
            
            #mainDiv{
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }
            
            #letsPlay{
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }
        </style>
    </head>
    <body>
        
        <div id="play">
            <div id="letsPlay">
                <h2>Press Enter to Catch the Squares!</h2>
            </div>   
           
            <div id="coolDiv"></div>
        </div>
        
        <script src="jquery-3.2.1.min.js"></script>
        <script>
            
            
            
            var left = $('#coolDiv').offset().left;
            var windowHeight = $(window).height();
            var divHeight = $('#coolDiv').height();
            var newPos = windowHeight - divHeight;
            var divSize;
            var flag;
            var sum = 1;
            
            function calcNewPos(heightLarge){
                var newPosLarge = windowHeight - heightLarge;
                return newPosLarge;
            }
            
            $(document).keypress(function(e){
                if (e.which == 13){
                    $('#letsPlay').hide();
                    $valDiv = $('<span/>').html(sum).css({
                        position: 'absolute',
                        left: '50%',
                        top: '50%',
                        transform: 'translate(-50%, -50%)'
                    }).appendTo('#coolDiv');
                    makeDiv();    
                }
            });
            
            function makeDiv(){
                flag = false;
                divSize  = ((Math.random()*50) + 20).toFixed();
                var posx = Math.floor((Math.random() * ($('#play').width() - divSize))).toFixed();
                var posy = Math.floor((Math.random() * ($('#play').height() - divSize))).toFixed();
                
                
                let color = '#' + Math.round(0xffffff * Math.random()).toString(16);
                while(color == "#d3d3d3"){
                    color = '#' + Math.round(0xffffff * Math.random()).toString(16);
                }
                    $newdiv = $('<div/>').css({
                        width: divSize+'px',
                        height: divSize+'px',
                        backgroundColor: color,
                        borderRadius: '3px'
                    });
                
              
                
                
                var ra = Math.floor(Math.random() * 4);
                
                /*.fadeOut(1000, function(){
                            $(this).remove();
                            makeDiv();
                        });*/
            
                if(!flag){            
                   switch(ra){
                        case 0:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            left: 0,
                            top: posy+'px',
                            display: 'none'
                            }).appendTo('#play').fadeIn(200).delay('slow');
                            break;
                        case 1:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            right: 0,
                            top: posy+'px',
                            display: 'none'
                            }).appendTo('#play').fadeIn(200).delay('slow');
                            break;
                        case 2:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            left: posx+'px',
                            top: 0,
                            display: 'none'
                            }).appendTo('#play').fadeIn(200).delay('slow');
                            break;
                        case 3:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            left: posx+'px',
                            bottom: 0,
                            display: 'none'
                            }).appendTo('#play').fadeIn(200).delay('slow');
                            break;
                        default:
                            return;

                    } /* switch statement*/
                } /*If $newDiv.length == 0*/
                else
                    return false;
                
                
                
            }
            
            var thisDiv = $('#coolDiv');
            var np;
            $(document).keydown(function(e){
                switch(e.which) {
                    case 37: // left
                        np = calcNewPos(thisDiv.height());
                        $('#coolDiv').animate({right:np}, 'fast',
                            function(){
                                $('#coolDiv').css({
                                    left: 0,
                                    right: 'auto'
                                });
                        });
                        
                        
                        
                        if(($newdiv.position().top === 0) && (thisDiv.position().top === 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                            makeDiv();
                            
                        }
                        
                        else if((($newdiv.offset().top + $newdiv.height()) >= $(window).height()) && ($('#coolDiv').offset().top + thisDiv.height() >= ($(window).height() - 5))){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                            makeDiv();
                        }
                        
                        console.log($valDiv.html());
                        
                        break;

                    case 38: // up
                        
                        np = calcNewPos(thisDiv.height());
                        $('#coolDiv').animate({bottom:np}, "fast", function(){
                            $('#coolDiv').css({
                                top: 0,
                                bottom: 'auto'
                            });
                        });

                        if((($newdiv.offset().left + $newdiv.width()) >= $('#play').width()) && ((thisDiv.offset().left + thisDiv.width()) >= $('#play').width() ) ){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                            
                            makeDiv();
                        }
                        else if(($newdiv.position().left === 0) && (thisDiv.position().left == 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                            
                            makeDiv();
                        }
                    
                        console.log($newdiv.offset().left + $newdiv.width())
                        console.log(thisDiv.offset().left + thisDiv.width())
                        console.log($('#play').width())

                        break;

                    case 39: // right
                        np = calcNewPos(thisDiv.height());
                        $('#coolDiv').animate({left:np}, "fast", 
                        function(){
                            $('#coolDiv').css({
                                right: 0,
                                left: 'auto'
                            });
                        });
                        
                        if(($newdiv.position().top === 0) && (thisDiv.position().top === 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                        
                            makeDiv();
                        }
                        
                        else if((($newdiv.offset().top + $newdiv.height()) >= windowHeight) && (thisDiv.offset().top + thisDiv.height()) >= (windowHeight - 5)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                            
                            makeDiv();
                        }
                        
                        console.log(thisDiv.offset().top + thisDiv.height())
                        break;

                    case 40: // down     
                       np = calcNewPos(thisDiv.height());
                       $('#coolDiv').animate({top:np}, "fast", function(){
                           $('#coolDiv').css({
                              bottom: 0,
                               top: 'auto'
                           });
                       });
                        
                        if(($newdiv.position().left === 0) && (thisDiv.position().left === 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                            
                            makeDiv();
                        }
                        else if((($newdiv.offset().left + $newdiv.width()) >= $('#play').width()) && ((thisDiv.offset().left + thisDiv.width()) >= $('#play').width())){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=' + (divSize/3 + 'px'),
                                height: '+=' + (divSize/3 + 'px')
                            });
                            $($valDiv).html(++sum);
                            flag = false;
                            
                            makeDiv();
                                
                        }
                        break;

                    default: return; // exit this handler for other keys
                }
                e.preventDefault(); // prevent the default action (scroll / move caret)
            });
        </script>
    </body>
</html>