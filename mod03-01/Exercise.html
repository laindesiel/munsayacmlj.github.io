<!DOCTYPE html>
<html>
    <head>
       
       <title>Catch the Squares!</title>
        <style>
            
            html{
                width: 100%;
                height: 100%;
                background-color: #fff;
                position: relative;
            }
            
            #play{
                width: 100%;
                height: 100%;
            }
            
            #coolDiv {
                width: 50px;
                height: 50px;
                position: absolute;
                top: 0;
                right: 0;
                background: black;
                border: 2px solid #333;
                border-radius: 5px;
            }
            
            #letsPlay{
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }
        </style>
    </head>
    <body>
        
        <div id="play">
            <div id="letsPlay">
                <h2>Press Enter to Catch the Squares!</h2>
            </div>   
           
            <div id="coolDiv"></div>
        </div>
        
        
        
        
        
        <script src="jquery-3.2.1.min.js"></script>
        <script>
            
            
            
            var left = $('#coolDiv').offset().left;
            var windowHeight = $(window).height();
            var divHeight = $('#coolDiv').height();
            var newPos = windowHeight - divHeight;
            var flag = false;
            
            function calcNewPos(heightLarge){
                var newPosLarge = windowHeight - heightLarge;
                return newPosLarge;
            }
            
            $(document).keypress(function(e){
                if (e.which == 13){
                    $('#letsPlay').hide();
                    makeDiv();    
                }
            });
            
            function makeDiv(){
                
                var divSize = ((Math.random()*100) + 50).toFixed();
                var posx = Math.floor((Math.random() * ($(document).width() - divSize))).toFixed();
                var posy = Math.floor((Math.random() * ($(document).height() - divSize))).toFixed();
                
                
                let color = '#' + Math.round(0xffffff * Math.random()).toString(16);
                $newdiv = $('<div/>').css({
                    width: divSize+'px',
                    height: divSize+'px',
                    backgroundColor: color,
//                    border: '1px solid #333',
                    borderRadius: '3px'
                });
                
                var ra = Math.floor(Math.random() * 4);
                
                /*.fadeOut(1000, function(){
                            $(this).remove();
                            makeDiv();
                        });*/
            
                if(!flag){            
                   switch(ra){
                        case 0:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            left: 0,
                            top: posy+'px',
                            display: 'none'
                            }).appendTo('body').fadeIn(200).delay(1000).fadeOut(2000, function(){
                                $(this).remove();
                                flag = false;
                                makeDiv();
                            });
                            break;
                        case 1:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            right: 0,
                            top: posy+'px',
                            display: 'none'
                            }).appendTo('body').fadeIn(200).delay(1000).fadeOut(2000, function(){
                                $(this).remove();
                                flag = false;
                                makeDiv();
                            });
                            break;
                        case 2:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            left: posx+'px',
                            top: 0,
                            display: 'none'
                            }).appendTo('body').fadeIn(200).delay(1000).fadeOut(2000, function(){
                                $(this).remove();
                                flag = false;
                                makeDiv();
                            });
                            break;
                        case 3:
                            flag = true;
                            $newdiv.css({
                            position: 'absolute',
                            left: posx+'px',
                            bottom: 0,
                            display: 'none'
                            }).appendTo('body').fadeIn(200).delay(1000).fadeOut(2000, function(){
                                $(this).remove();
                                flag = false;
                                makeDiv();
                            });
                            break;
                        default:
                            return;

                    } /* switch statement*/
                } /*If $newDiv.length == 0*/
                else
                    return false;
                
                
                console.log($newdiv.length);
                console.log($newdiv.position().left, $newdiv.position().top);
                
                
            }
            
            var thisDiv = $('#coolDiv');
            var np;
            $(document).keydown(function(e){
                switch(e.which) {
                    case 37: // left
                        np = calcNewPos(thisDiv.height());
                        $('#coolDiv').animate({right:np}, "slow",
                            function(){
                                $('#coolDiv').css({
                                    left: 0,
                                    right: 'auto'
                                });
                        });
                        
                        if(($newdiv.position().top === 0) && ($('#coolDiv').position().top === 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                            
                        }
                        else if((($newdiv.position().top) + ($newdiv.height()) > 800) && ($('#coolDiv').position().top + thisDiv.height() > 800)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                        }
                        
                        console.log(thisDiv.height())
                        
                        break;

                    case 38: // up
                        
                        np = calcNewPos(thisDiv.height());
                        $('#coolDiv').animate({bottom:np}, "slow", function(){
                            $('#coolDiv').css({
                                top: 0,
                                bottom: 'auto'
                            });
                        });
                        
                        if(($newdiv.position().left + $newdiv.height() > 800) && $('#coolDiv').position().left > 0){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                        }
                        else if(($newdiv.position().left === 0) && ($('#coolDiv').position().left == 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                        }
                    
                        break;

                    case 39: // right
                        np = calcNewPos(thisDiv.height());
                        $('#coolDiv').animate({left:np}, "slow", 
                        function(){
                            $('#coolDiv').css({
                                right: 0,
                                left: 'auto'
                            });
                        });
                        
                        if(($newdiv.position().top === 0) && ($('#coolDiv').position().top === 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                        }
                        else if(($newdiv.position().top + $newdiv.height() > 800) && ($('#coolDiv').position().top + thisDiv.height() > 800)){
                                $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                        }
                        break;

                    case 40: // down     
                       np = calcNewPos(thisDiv.height());
                       $('#coolDiv').animate({top:np}, "slow", function(){
                           $('#coolDiv').css({
                              bottom: 0,
                               top: 'auto'
                           });
                       });
                        
                        if(($newdiv.position().left === 0) && (thisDiv.position().left === 0)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                        }
                        else if(($newdiv.position().left + $newdiv.height() > 800) && (thisDiv.position().left + thisDiv.height() > 800)){
                            $newdiv.remove();
                            $('#coolDiv').css({
                                width: '+=20px',
                                height: '+=20px'
                            });
                            flag = false;
                            makeDiv();
                        }
                        break;

                    default: return; // exit this handler for other keys
                }
                e.preventDefault(); // prevent the default action (scroll / move caret)
            });
        </script>
    </body>
</html>